import Conn
import FullList

dst_file = "/index.php"

def Scan(url,verbose,outdir):
	res = Conn.Connect(1,url + dst_file)
	if verbose == True:
		print "[+] Testing '" + url + dst_file + "' ..."
	if res == 1: #If there's an error in the connection
		print "[-] Connection error.\nCheck if URL is valid and target is up and listening on the specified port.\n"
	else:
		if res == 200: #If the retrieval was OK
			print "[+] " + url + " seems exploitable. Enjoy :)\n"
		else: #If the retrieval failed
			print "[-] " + url + " is probably NOT exploitable :(\nYou should run the 'full' module anyway, just in case.\n"

	print "Would you like to run the 'full' scan module? [Y/n]",
	yes = set(['yes','y', 'ye', ''])
	no = set(['no','n'])
	r = None
	while (r == None):
		choice = raw_input().lower()
		if choice in yes:
			FullList.Scan(url,verbose,outdir)
			r = 1
		elif choice in no:
			return False
			r = 1
		else:
			print "Please respond with 'yes' or 'no'",
